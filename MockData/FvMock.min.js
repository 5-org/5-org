!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.FvMock=e():t.FvMock=e()}(this,(function(){return function(t){function e(s){if(n[s])return n[s].exports;var o=n[s]={exports:{},id:s,loaded:!1};return t[s].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){var s;e=n(3),"undefined"!=typeof window&&(s=n(3));var o={Util:e,XHR:s,heredoc:e.heredoc,setup:function(t){return s.setup(t)},_mocked:{},version:"1.0.1-beta3"};s&&(s.FvMock=o),o.mock=function(t,e,n){return s&&(window.XMLHttpRequest=s),o._mocked[t+(e||"")]={rurl:t,rtype:e,template:n},o},t.exports=o},function(t,e){var n={extend:function(){var t,e,s,o=arguments[0]||{},r=1,i=arguments.length;for(1===i&&(o=this,r=0);r<i;r++)if(t=arguments[r])for(e in t){var a=o[e],c=t[e];o!==c&&void 0!==c&&(n.isArray(c)||n.isObject(c)?(n.isArray(c)&&(s=a&&n.isArray(a)?a:[]),n.isObject(c)&&(s=a&&n.isObject(a)?a:{}),o[e]=n.extend(s,c)):o[e]=c)}return o},each:function(t,e,n){var s;if("number"===this.type(t))for(s=0;s<t;s++)e(s,s);else if(t.length===+t.length)for(s=0;s<t.length&&!1!==e.call(n,t[s],s,t);s++);else for(s in t)if(!1===e.call(n,t[s],s,t))break},type:function(t){return null==t?String(t):Object.prototype.toString.call(t).match(/\[object (\w+)\]/)[1].toLowerCase()}};n.each(["String","Object","Array","RegExp","Function"],(function(t){n["is"+t]=function(e){return n.type(e)===t.toLowerCase()}})),n.noop=function(){},t.exports=n},function(t,e,n){t.exports=n(3)},function(t,e,n){function s(){this.custom={events:{},requestHeaders:{},responseHeaders:{}}}var o=n(1);window._XMLHttpRequest=window.XMLHttpRequest,window._ActiveXObject=window.ActiveXObject;try{new window.Event("custom")}catch(t){window.Event=function(t,e,n,s){var o=document.createEvent("CustomEvent");return o.initCustomEvent(t,e,n,s),o}}e={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4};var r="readystatechange loadstart progress abort error load timeout loadend".split(" "),i=["timeout","withCredentials"],a="readyState responseURL status statusText responseType response responseText responseXML".split(" "),c="OK";s._settings={timeout:"10-100"},s.setup=function(t){return o.extend(s._settings,t),s._settings},o.extend(s,e),o.extend(s.prototype,e),s.prototype.mock=!0,s.prototype.match=!1,o.extend(s.prototype,{open:function(t,e,n,c,u){function p(t){for(var e=0;e<a.length;e++)try{d[a[e]]=f[a[e]]}catch(t){}d.dispatchEvent(new Event(t.type))}var d=this;o.extend(this.custom,{method:t,url:e,async:"boolean"!=typeof n||n,username:c,password:u,options:{url:e,type:t}}),this.custom.timeout=function(t){if("number"==typeof t)return t;if("string"==typeof t&&!~t.indexOf("-"))return parseInt(t,10);if("string"==typeof t&&~t.indexOf("-")){var e=t.split("-");return t=parseInt(e[0],10),e=parseInt(e[1],10),Math.round(Math.random()*(e-t))+t}}(s._settings.timeout);var h=function(t){function e(t,e){return"string"===o.type(t)?t===e:"regexp"===o.type(t)?t.test(e):void 0}for(var n in s.FvMock._mocked){var r=s.FvMock._mocked[n];if(!(r.rurl&&!e(r.rurl,t.url)||r.rtype&&!e(r.rtype,t.type.toLowerCase())))return r}}(this.custom.options);if(h)this.match=!0,this.custom.template=h,this.readyState=s.OPENED,this.dispatchEvent(new Event("readystatechange"));else{var f=function(){function t(){try{return new window._XMLHttpRequest}catch(t){}}var e,n=(e=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/.exec(location.href.toLowerCase())||[],/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(e[1]));if(window.ActiveXObject){if(!(n=!n&&t()))t:{try{n=new window._ActiveXObject("Microsoft.XMLHTTP");break t}catch(e){}n=void 0}}else n=t();return n}();for(this.custom.xhr=f,h=0;h<r.length;h++)f.addEventListener(r[h],p);for(c?f.open(t,e,n,c,u):f.open(t,e,n),t=0;t<i.length;t++)try{f[i[t]]=d[i[t]]}catch(t){}}},setRequestHeader:function(t,e){if(this.match){var n=this.custom.requestHeaders;n[t]=n[t]?n[t]+","+e:e}else this.custom.xhr.setRequestHeader(t,e)},timeout:0,withCredentials:!1,upload:{},send:function(t){function e(){n.readyState=s.HEADERS_RECEIVED,n.dispatchEvent(new Event("readystatechange")),n.readyState=s.LOADING,n.dispatchEvent(new Event("readystatechange")),n.status=200,n.statusText=c,n.response=n.responseText=JSON.stringify(function(t,e){return o.isFunction(t.template)?t.template(e):s.FvMock.mock(t.template)}(n.custom.template,n.custom.options),null,4),n.readyState=s.DONE,n.dispatchEvent(new Event("readystatechange")),n.dispatchEvent(new Event("load")),n.dispatchEvent(new Event("loadend"))}var n=this;this.custom.options.body=t,this.match?(this.setRequestHeader("X-Requested-With","FvMockXMLHttpRequest"),this.dispatchEvent(new Event("loadstart")),this.custom.async?setTimeout(e,this.custom.timeout):e()):this.custom.xhr.send(t)},abort:function(){this.match?(this.readyState=s.UNSENT,this.dispatchEvent(new Event("abort",!1,!1,this)),this.dispatchEvent(new Event("error",!1,!1,this))):this.custom.xhr.abort()}}),o.extend(s.prototype,{responseURL:"",status:s.UNSENT,statusText:"",getResponseHeader:function(t){return this.match?this.custom.responseHeaders[t.toLowerCase()]:this.custom.xhr.getResponseHeader(t)},getAllResponseHeaders:function(){if(!this.match)return this.custom.xhr.getAllResponseHeaders();var t,e=this.custom.responseHeaders,n="";for(t in e)e.hasOwnProperty(t)&&(n+=t+": "+e[t]+"\r\n");return n},overrideMimeType:function(){},responseType:"",response:null,responseText:"",responseXML:null}),o.extend(s.prototype,{addEventListener:function(t,e){var n=this.custom.events;n[t]||(n[t]=[]),n[t].push(e)},removeEventListener:function(t,e){t=this.custom.events[t]||[];for(var n=0;n<t.length;n++)t[n]===e&&t.splice(n--,1)},dispatchEvent:function(t){for(var e=this.custom.events[t.type]||[],n=0;n<e.length;n++)e[n].call(this,t);this[e="on"+t.type]&&this[e](t)}}),t.exports=s}])}));